---
import Loading from '../components/Loading.astro';

interface Props {
	projectNumber?: string;
}

const { projectNumber } = Astro.props;
---

<div id="project-detail-container">
	<Loading />
</div>

<script define:vars={{ projectNumber }}>
	(async function() {
		const container = document.getElementById('project-detail-container');
		if (!container) return;

		try {
			const response = await fetch(`/partials/projects/${projectNumber}`);
			if (!response.ok) throw new Error('Failed to load project');
			const html = await response.text();
			container.innerHTML = html;
            
            // Dispatch event to notify that content is loaded
            const event = new CustomEvent('project-content-loaded');
            document.dispatchEvent(event);
		} catch (error) {
			console.error('Error loading project:', error);
			container.innerHTML = `
				<div class="p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400 m-4" role="alert">
					<span class="font-medium">Error!</span> Failed to load project. Please try again later.
				</div>
			`;
		}
	})();
</script>

<script>
	import './ProjectDetail.client.js';
</script>
